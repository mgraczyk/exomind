{% extends "base.html" %}
{% block content %}

{% load humanize %}
{% load tags %}

<div>
  <h4>
  <a class="title" href="{% url 'full_review' review_id=review.id %}">
    <em>{% if review.name %}{{review.name}}{%else%}no title{%endif%}</em>
  </a>
  </h4>
  <p>
    {{review.url|nice_urlize:60}}
    <br>
    Created by
    <a href="/profiles/{{review.user.id}}">@{{review.user.username}}</a>
    {{review.time|naturaltime }}
  </p>
  <div>Rating: {{review.rating}}</div>
  <div title="Rating {{review.rating}}">
    <i class="material-icons tiny" style="word-spacing: -5px">{{review.rating|star_string}}</i>
  </div>

  <p>
    {{review.text}}
  </p>

  {% if review.reaction_data.explicit %}
  Liked by
  {% for reaction in review.reaction_data.explicit %}
    <a href="/profiles/{{reaction.user_id}}">@{{reaction.username}}</a>
    {% if not forloop.last %}, {% endif %}
  {% endfor %}
  <br>
  {% endif %}

  <form class="EXM-like-form" method="POST"
        action="{% url 'react_to_review' review_id=review.id %}?full=1">
    {% csrf_token %}
    <button type="submit" class="btn-flat waves-effect waves-light hvr-gray">Like</button>
  </form>

  {% if review.user.id == me.id %}
    <span>
      <a href="{% url 'manage_review' review_id=review.id %}" class="btn-flat hvr-gray">Edit</a>
    </span>
  {% endif %}
</div>

{% endblock %}
